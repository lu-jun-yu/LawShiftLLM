# T2.4 action_reallocated_reduce (行为重分配缩减)

## 基本信息

| 属性 | 值 |
|------|-----|
| 类型编号 | T2.4 |
| 名称 | action_reallocated_reduce |
| 标签 | NV (Non-Valid) |
| 源文件 | `CONSTRUCT_action_reallocated_reduce.py` |
| 目标法条 | 354-0-0 (容留他人吸毒罪) |

## 处理概述

该修订类型使用**LLM (大语言模型) API**来修改案件事实，将"容留他人吸食毒品"的行为改为"容留他人注射毒品"。这改变了毒品使用的具体方式。

## 筛选条件

```python
if case["relevant_articles"][0] == "354-0-0" and \
   case["fact"].find("容留") != -1 and \
   len(case["fact"]) > 245 and \
   len(case["fact"]) < 270:
```

- 法条：354-0-0（容留他人吸毒罪）
- 包含关键词："容留"
- 文本长度：245-270字之间

## LLM调用参数

```python
SYS = "你是一个中国司法领域的专家"
model = "gpt-4o"
temperature = 0.3  # 低随机性，确保输出一致
```

## Prompt设计

### System Prompt
```
你是一个中国司法领域的专家
```

### User Prompt
```
#背景#

现在需要你修改一个犯罪嫌疑人的经历的场景，让犯罪嫌疑人生成一段符合"容留他人进行毒品注射"的经历。

#要求#

1. 你需要根据下列用XML符号隔开的<参考例子>的修改方式，生成<输入>对应的修改，并用<输出>XML符号隔开。
2. <输出>部分字数在200字左右。
3. 不要涉及案件进度，如"进一步审理中"、"被法律制裁"这类内容。
4. 注意，指描述犯罪活动描述，不要设计判决性的定性语言...
5. 不要编造出更多角色，只让经历里的人物的行为为规定的犯罪行为。
6. 生成故事的语气参考输入例子的经历。

<参考例子>
<修改前>
...容留朱某吸食毒品一次...
</修改前>

<修改后>
...容留朱某注射毒品一次...
</修改后>
</参考例子>

<输入>
{case["fact"]}
</输入>
```

## 修改效果示例

**修改前：**
> 2020年10月31日下午，被告人佟洪安让朱某购买冰毒，之后于当日下午2时许，在双阳区云山街道宋家4社自己家里，**容留朱某吸食毒品一次**...

**修改后：**
> 2020年10月31日下午，被告人佟洪安让朱某**进行冰毒注射**，之后于当日下午2时许，在双阳区云山街道宋家4社自己家里，**容留朱某注射毒品一次**...

## 输出解析

```python
pattern = r'<输出>(.*?)</输出>'
match = re.search(pattern, response, re.DOTALL)
if match:
    return match.group(1)
else:
    return response
```

## NV标签解释

该修订被标记为NV(Non-Valid)的原因：
- 改变了毒品使用的具体方式（吸食→注射）
- "注射毒品"与"吸食毒品"在法律上可能有不同的认定标准
- 行为方式的改变可能影响犯罪情节的严重程度判断

## 处理方式特点

| 特点 | 说明 |
|------|------|
| 使用LLM | 而非简单的字符串替换 |
| Few-shot Learning | 提供参考例子指导LLM |
| 低温度设置 | 0.3，确保输出稳定性 |
| XML标签结构化 | 便于解析LLM输出 |

## 数据流

```
原始数据 → 筛选条件 → LLM API调用 → XML解析输出 → 保存数据集:
  ├── rid_short_tail_testing_set_poisoned_1 (完整数据集)
  ├── only_poinsoned_testing_set_poisoning_1 (污染后案件)
  └── only_poinsoned_testing_set_original_1 (原始案件)
```

## 输出文件

- `tasks/constituteElement_action_activity_abstraction_overlap_shrink/rid_short_tail_testing_set_poisoned_1_update_2.json`
- `tasks/constituteElement_action_activity_abstraction_overlap_shrink/only_poinsoned_testing_set_poisoning_1_update_2.json`
- `tasks/constituteElement_action_activity_abstraction_overlap_shrink/only_poinsoned_testing_set_original_1_update_2.json`
