# T2.5 action_explicit_reduce (行为显式缩减)

## 基本信息

| 属性 | 值 |
|------|-----|
| 类型编号 | T2.5 |
| 名称 | action_explicit_reduce |
| 标签 | NV (Non-Valid) |
| 源文件 | `CONSTRUCT_action_explicit_reduce.py` |
| 目标法条 | 354-0-0 (容留他人吸毒罪) |

## 处理概述

该修订类型结合**LLM生成**和**字符串替换**两种方式，将"容留他人吸食毒品"改为"容留他人注射毒品"。这是一种"显式"的行为缩减，因为替换操作是明确、直接的。

## 筛选条件

```python
if case["relevant_articles"][0] == "354-0-0" and \
   case["fact"].find("容留") != -1 and \
   len(case["fact"]) > 245 and \
   len(case["fact"]) < 270:
```

## LLM Prompt设计

### System Prompt
```
你是一个中国司法领域的专家
```

### User Prompt 背景说明
```
现在需要你修改一个犯罪嫌疑人的经历的场景，让犯罪嫌疑人生成一段符合"容留他人注射毒品"的经历。
```

## 处理逻辑

### 两步处理法

**步骤1：LLM生成**
```python
prompt = API_prompt_case_from_LLM(case["fact"], "gpt-4o")
```

**步骤2：字符串显式替换**
```python
prompt = prompt.replace("吸食", "注射")
prompt = prompt.replace("吸毒", "注射毒品")
```

### 核心代码

```python
for case in rid_short_tail_testing_set_original:
    if case["relevant_articles"][0] == "354-0-0" and \
       case["fact"].find("容留") != -1 and \
       len(case["fact"]) > 245 and len(case["fact"]) < 270:

        original_case = case.copy()
        only_poinsoned_testing_set_original_1.append(original_case)

        # LLM生成
        prompt = API_prompt_case_from_LLM(case["fact"], "gpt-4o")

        # 显式替换
        prompt = prompt.replace("吸食", "注射")
        prompt = prompt.replace("吸毒", "注射毒品")

        case["fact"] = prompt
        only_poinsoned_testing_set_poisoning_1.append(case)
```

## 修改效果示例

**修改前：**
> 2019年9月23日16时许，民警在峨山县王军家中将涉嫌**吸毒**的王军、孙某查获...被告人王军在峨山县余次容留孙某**吸食**毒品"小麻"。

**修改后：**
> 2019年9月23日16时许，民警在峨山县王军家中将涉嫌**注射毒品**的王军、孙某查获...被告人王军在峨山县余次容留孙某**注射**毒品"小麻"。

## T2.4 vs T2.5 对比

| 特性 | T2.4 action_reallocated_reduce | T2.5 action_explicit_reduce |
|------|--------------------------------|------------------------------|
| LLM使用 | 完全依赖LLM生成 | LLM生成 + 字符串替换 |
| 替换方式 | LLM理解后重写 | 显式replace操作 |
| 可控性 | 较低（依赖LLM理解） | 较高（明确替换规则） |
| 一致性 | 可能有变化 | 替换规则固定 |

## NV标签解释

该修订被标记为NV(Non-Valid)的原因：
- **显式**替换"吸食"为"注射"、"吸毒"为"注射毒品"
- 改变了犯罪行为的具体表现形式
- 替换操作是明确的、可追踪的

## "显式"的含义

- 替换规则是固定的、明确的
- 使用`str.replace()`进行直接替换
- 不依赖LLM的语义理解来完成关键词替换
- 处理结果可预测、可复现

## 数据流

```
原始数据 → 筛选条件 → LLM生成基础文本 → 显式字符串替换 → 保存数据集:
  ├── rid_short_tail_testing_set_poisoned_1 (完整数据集)
  ├── only_poinsoned_testing_set_poisoning_1 (污染后案件)
  └── only_poinsoned_testing_set_original_1 (原始案件)
```

## 输出文件

- `tasks/constituteElement_action_activity_coordinate_remove/rid_short_tail_testing_set_poisoned_1_update_3.json`
- `tasks/constituteElement_action_activity_coordinate_remove/only_poinsoned_testing_set_poisoning_1_update_3.json`
- `tasks/constituteElement_action_activity_coordinate_remove/only_poinsoned_testing_set_original_1_update_3.json`
